(this["webpackJsonptetris-react"]=this["webpackJsonptetris-react"]||[]).push([[0],[,,,,,function(e,t,a){e.exports={container:"Tetris_container__20ep0",grid:"Tetris_grid__yl3dw",board:"Tetris_board__3uyNg",aside:"Tetris_aside__2s9F8"}},function(e,t,a){e.exports={backdrop:"Modal_backdrop__1mfF6",modal:"Modal_modal__4DXUe","slide-down":"Modal_slide-down__W3MdX",content:"Modal_content__3zUnK"}},,function(e,t,a){e.exports={score:"Display_score__2OzJG"}},function(e,t,a){e.exports={next:"Next_next__2f2ey"}},,,,,function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),c=a(4),o=a.n(c),s=(a(14),a(3)),l={COLS:10,ROWS:20,BLOCK_SIZE:30,BG_COLOR:"rgba(104, 66, 126, 0.4)"},i=l,u=Array.from({length:l.ROWS},(function(){return Array(l.COLS).fill(0)})),O={SINGLE:100,DOUBLE:300,TRIPLE:500,TETRIS:800,SOFT_DROP:1,HARD_DROP:2,NONE:0},d={1:800,2:720,3:630,4:550,5:470,6:380,7:300,8:220,9:130,10:100,11:80,12:80,13:80,14:70,15:70,16:70,17:50,18:50,19:50,20:30},f={L:{shape:[["L",0],["L",0],["L","L"]],color:"#3d84b8"},I:{shape:[["I","I","I","I"]],color:"#e25822"},J:{shape:[[0,"J"],[0,"J"],["J","J"]],color:"#006a71"},O:{shape:[["O","O"],["O","O"]],color:"#f1bc31"},S:{shape:[[0,"S","S"],["S","S",0]],color:"#a9294f"},T:{shape:[["T","T","T"],[0,"T",0]],color:"#ad62aa"},Z:{shape:[["Z","Z",0],[0,"Z","Z"]],color:"#206a5d"}};function j(){return Object.keys(f)[Math.floor(7*Math.random())]}function b(e){for(var t=Array.from({length:e[0].length},(function(){return Array(e.length).fill(0)})),a=0;a<e.length;a++)for(var r=0;r<e[0].length;r++)t[r][a]=e[a][r];return t.forEach((function(e){return e.reverse()})),t}function h(e,t){var a=e.x,r=e.y,n=e.shape;return!(a<0||a+n[0].length>i.COLS)&&(!(r+n.length>i.ROWS)&&!n.some((function(e,n){return e.some((function(e,c){return r+n>=0&&0!==e&&0!==t[r+n][a+c]}))})))}function v(e,t,a,r){0!==e&&(r.beginPath(),r.fillStyle=e,r.fillRect(t,a,1,1))}var p=a(0),y=i.COLS,x=i.ROWS,g=i.BLOCK_SIZE,S=function(e){var t=e.playerState,a=e.stageState,n=e.className,c=e.gameState,o=Object(r.useRef)(null),s=c.isGameOver;return Object(r.useEffect)((function(){var e=o.current,r=e.getContext("2d");if(r.canvas.width=y*g,r.canvas.height=x*g,r.scale(g,g),r.clearRect(0,0,e.width,e.height),r.beginPath(),!s){a.forEach((function(e,t){return e.forEach((function(e,a){0!==e&&v(f[e].color,a,t,r)}))}));var n=t.shape,c=t.color,l=t.x,i=t.y;a[0].every((function(e){return 0===e}))&&n.forEach((function(e,t){return e.forEach((function(e,n){0!==e&&i+t>=0&&0===a[i+t][l+n]&&v(c,l+n,i+t,r)}))}))}}),[a,t,s]),Object(p.jsx)("canvas",{ref:o,className:n})},m=a(5),_=a.n(m),C=a(8),E=a.n(C),L=function(e){return Object(p.jsxs)("div",{className:E.a.score,children:[e.title,": ",Object(p.jsx)("span",{children:e.value})]})},R=function(){var e=Object(r.useState)(u),t=Object(s.a)(e,2),a=t[0],n=t[1];return[a,function(e){var t=JSON.parse(JSON.stringify(a));e.shape.forEach((function(a,r){e.y+r>=0&&a.forEach((function(a,n){0!==a&&(t[e.y+r][e.x+n]=a)}))}));var r=function(e){var t=0,a=[];return e.forEach((function(e,r){e.some((function(e){return 0===e}))?a.push(e):(t++,a.unshift(Array(i.COLS).fill(0)))})),[a,t]}(t),c=Object(s.a)(r,2),o=c[0],l=c[1];return n((function(){return o})),l},function(){n((function(){return u}))}]},N=a(2);function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"L",t=f[e].shape,a=f[e].color;return{x:4,y:0,shape:t,color:a,isCollided:!1,dropType:"NONE",next:j()}}function w(e,t){switch(t.type){case"Reset":return T(e.next);case"ArrowDown":var a=Object(N.a)(Object(N.a)({},e),{},{y:e.y+1});return h(a,t.payload)?a:Object(N.a)(Object(N.a)({},e),{},{dropType:"SOFT_DROP",isCollided:!0});case"ArrowLeft":var r=Object(N.a)(Object(N.a)({},e),{},{x:e.x-1});return h(r,t.payload)?r:e;case"ArrowRight":var n=Object(N.a)(Object(N.a)({},e),{},{x:e.x+1});return h(n,t.payload)?n:e;case"ArrowUp":var c=Object(N.a)(Object(N.a)({},e),{},{shape:b(e.shape)});return h(c,t.payload)?c:e;case"Space":for(var o=e;h(o,t.payload);)o=Object(N.a)(Object(N.a)({},o),{},{y:o.y+1});return Object(N.a)(Object(N.a)({},o),{},{y:o.y-1,isCollided:!0,dropType:"HARD_DROP"});default:return e}}var G=function(e,t){var a=Object(r.useReducer)(w,T()),n=Object(s.a)(a,2),c=n[0],o=n[1];return Object(r.useEffect)((function(){var a;return t.isGameOver||t.isPause||(a=setInterval((function(){return o({type:"ArrowDown",payload:e})}),d[t.level])),function(){clearInterval(a)}}),[c,t,e]),[c,o]},I={score:0,level:1,lines:0,isGameOver:!0,isPause:!1};function P(e,t){switch(t.type){case"ResetGame":return Object(N.a)(Object(N.a)({},I),{},{isGameOver:!1});case"SetGameOver":return Object(N.a)(Object(N.a)({},e),{},{isGameOver:!0});case"TogglePause":return Object(N.a)(Object(N.a)({},e),{},{isPause:!e.isPause});case"AddLines":return Object(N.a)(Object(N.a)({},e),{},{lines:e.lines+t.payload});case"ChangeScore":return Object(N.a)(Object(N.a)({},e),{},{score:e.score+t.payload});case"ChangeLevel":var a=e.level+t.payload;return a<1?a=1:a>10&&(a=10),Object(N.a)(Object(N.a)({},e),{},{level:a});default:return e}}var D=function(){var e=Object(r.useReducer)(P,I),t=Object(s.a)(e,2),a=t[0],n=t[1],c=Math.floor(a.lines/3);return Object(r.useEffect)((function(){n({type:"ChangeLevel",payload:1})}),[c,n]),[a,n]},A=a(9),M=a.n(A),J=function(e){var t=e.playerState,a=e.gameState,n=Object(r.useRef)(null);return Object(r.useEffect)((function(){if(!a.isGameOver){var e=n.current,r=e.getContext("2d"),c=f[t.next].shape,o=f[t.next].color,s=i.BLOCK_SIZE;r.canvas.width=c[0].length*s,r.canvas.height=c.length*s,r.scale(s,s),r.clearRect(0,0,e.width,e.height),r.beginPath(),c.forEach((function(e,t){return e.forEach((function(e,a){0!==e&&v(o,a,t,r)}))}))}}),[t,a.isGameOver]),Object(p.jsx)("canvas",{ref:n,className:M.a.next})},k=a(6),B=a.n(k),Z=function(e){return Object(p.jsx)("div",{className:B.a.backdrop,onClick:e.onClose})},F=function(e){return Object(p.jsx)("div",{className:B.a.modal,children:Object(p.jsx)("div",{className:B.a.content,children:e.children})})},K=document.getElementById("overLay"),U=function(e){return Object(p.jsxs)(r.Fragment,{children:[o.a.createPortal(Object(p.jsx)(Z,{onClose:e.onClose}),K),o.a.createPortal(Object(p.jsx)(F,{children:e.children}),K)]})},W=function(e){return Object(p.jsxs)(U,{onClose:e.closeModal,children:[Object(p.jsx)("h1",{children:"Game Over!"}),Object(p.jsxs)("h2",{children:["score: ",e.score]}),Object(p.jsx)("button",{onClick:e.reStart,children:"Restart"})]})},z=function(){var e=Object(r.useState)(!1),t=Object(s.a)(e,2),a=t[0],n=t[1],c=R(),o=Object(s.a)(c,3),l=o[0],i=o[1],u=o[2],d=D(),f=Object(s.a)(d,2),j=f[0],b=f[1],h=G(l,j),v=Object(s.a)(h,2),y=v[0],x=v[1],g=l[0].some((function(e){return 0!==e}));Object(r.useEffect)((function(){g&&(b({type:"SetGameOver"}),n(!0))}),[b,g]),Object(r.useEffect)((function(){if(!g&&y.isCollided){var e=i(y);b({type:"AddLines",payload:e}),b({type:"ChangeScore",payload:O[y.dropType]});var t=O.NONE;e>3?(t=O.TETRIS,j.level>6&&b({type:"ChangeLevel",payload:-3})):e>2?(t=O.TRIPLE,j.level>6&&b({type:"ChangeLevel",payload:-2})):e>1?t=O.DOUBLE:e>0&&(t=O.SINGLE,j.level>7&&b({type:"ChangeLevel",payload:-1})),b({type:"ChangeScore",payload:t}),x({type:"Reset"})}}),[g,y.isCollided]);var m=function(e){e.preventDefault(),C(e),j.isGameOver?(b({type:"ResetGame"}),u(),x({type:"Reset"})):b({type:"TogglePause"})},C=function(e){e.preventDefault(),n(!1)};return Object(p.jsxs)(r.Fragment,{children:[a&&Object(p.jsx)(W,{score:j.score,reStart:m,closeModal:C}),Object(p.jsx)("div",{className:_.a.container,onKeyDown:function(e){e.preventDefault(),y.isCollided||x({type:e.code,payload:l})},tabIndex:0,children:Object(p.jsxs)("div",{className:_.a.grid,children:[Object(p.jsx)(S,{className:_.a.board,stageState:l,playerState:y,gameState:j}),Object(p.jsxs)("aside",{className:_.a.aside,children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("h2",{children:"Tetris"}),Object(p.jsx)(L,{title:"Score",value:j.score}),Object(p.jsx)(L,{title:"Lines",value:j.lines}),Object(p.jsx)(L,{title:"Level",value:j.level}),Object(p.jsx)(L,{title:"Next",value:null}),Object(p.jsx)(J,{playerState:y,gameState:j})]}),Object(p.jsx)("button",{onClick:m,children:"".concat(j.isGameOver?"Start Game":j.isPause?"Continue":"Pause")})]})]})})]})};var H=function(){return Object(p.jsx)("div",{children:Object(p.jsx)(z,{})})};o.a.render(Object(p.jsx)(n.a.StrictMode,{children:Object(p.jsx)(H,{})}),document.getElementById("root"))}],[[16,1,2]]]);
//# sourceMappingURL=main.175f69bc.chunk.js.map